/*! l2box 2013-07-05 */
!function(a,b){function c(b,c){this.element=b,this.settings=a.extend(!0,{},l,c),this._defaults=l,this._name=j,this.$contents=null,this.reqUrl="",this.init()}function d(c){c.enableClipView&&(a("body").css({height:Math.max(parseInt(g.height())+4*parseInt(g.css("marginTop")),parseInt(a(b).height())),overflowY:"hidden"}),f.css({height:Math.max(parseInt(g.height())+4*parseInt(g.css("marginTop")),parseInt(a(b).height()))}),b.scrollTo(0,1))}function e(b){b.enableClipView&&a("body").removeAttr("style")}var f,g,h,i,j="l2box",k=j,l=(b.document,{enableClipView:!0,closeOnClickShadow:!0,closeOnClickButton:!0,target:"",params:{},type:"get",shadowCss:{position:"absolute",top:"0px",left:"0px",width:"100%",background:"rgba(0,0,0,0.5)",zIndex:1e4},btnCloseCss:{position:"absolute",top:"0px",right:"0px",width:"40px",height:"40px",fontSize:"26px",textAlign:"center",lineHeight:"40px",zIndex:10001},containerCss:{position:"absolute",top:"0px",left:"0px",width:"94%",margin:"10px 0px 0px 3%",padding:"10px",minHeight:"100px",background:"rgba(255,255,255,1)",borderRadius:"2px",boxShadow:"1px 0px 10px rgba(0,0,0,0.5)","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box",zIndex:10001},loadingCss:{padding:"40px 0px 30px",textAlign:"center"},duration:200}),m=[];c.prototype.init=function(){var b=this;if(f=a("."+k+"-shadow"),0===f.length&&(f=a("<div>").addClass(""+k+"-shadow").css(b.settings.shadowCss).hide().appendTo(a("body").css({position:"relative"})),b.settings.closeOnClickShadow&&f.bind("click",function(){b.hide()})),g=a("."+k+"-container"),0===g.length&&(g=a("<div>").addClass(""+k+"-container").css(this.settings.containerCss).hide().appendTo(a("body").css({position:"relative"})),h=a("<div>").addClass(""+k+"-contents_frame").appendTo(g),$loading=a("<div>").css(this.settings.loadingCss).html("Loading...").addClass(""+k+"-loading")),i=a("."+k+"-btn_close"),0===i.length&&b.settings.closeOnClickButton&&(i=a("<div>").addClass(""+k+"-btn_close").css(b.settings.btnCloseCss).append(a("<span>").html("+").css({display:"inline-block","-webkit-transform":"rotate(45deg)","-moz-transform":"rotate(45deg)"})).appendTo(g).bind("click",function(){b.hide()})),this.settings.target)this.$contents=a(this.settings.target);else{var c=a(this.element).attr("href"),d=a(this.element).attr("data-"+j+"-href");d&&(c=d),c&&(c.match(/^#/)?this.$contents=a(c):this.reqUrl=a(this.element).attr("href"))}a(this.element).bind("click",function(a){a.preventDefault(),b.show()})},c.prototype.updateView=function(){a("body").css({maxHeight:Math.max(parseInt(g.height())+4*parseInt(g.css("marginTop")),parseInt(a(b).height())),overflowY:"hidden"})},c.prototype.show=function(){var c=this;m.length||m.push(a(b).scrollTop()),this.$contents&&this.$contents.length?(f.height(a("body").height()).fadeIn(this.settings.duration),h.empty().append(this.$contents.show()),g.fadeIn(this.settings.duration),d(this.settings)):this.reqUrl&&(f.height(a("body").height()).fadeIn(this.settings.duration),g.fadeIn(this.settings.duration),h.empty().append($loading),d(this.settings),a.when(a.ajax({url:this.reqUrl,type:this.settings.type,data:this.settings.params})).done(function(b){c.$contents=a("<div>").html(b).find("img").load(function(){c.updateContainerSize()}).end(),c.show()}).fail(function(){alert("データを取得できませんでした"),c.hide()}))},c.prototype.hide=function(){g.hide(),f.hide(),e(this.settings),b.scrollTo(0,m[0]||0),m=[]},c.prototype.updateContainerSize=function(){f.height(a("body").height()),d(this.settings)},a.fn[j]=function(b){return this.each(function(){a.data(this,"plugin_"+j)||a.data(this,"plugin_"+j,new c(this,b))})}}(jQuery,window);